# pytest configuration for The Gathering test suite
# Modernized for pytest-asyncio 1.2.0 (October 2025)

[pytest]
# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Test markers with clear Separation of Concerns
markers =
    unit: Unit tests - Fast, SQLite, mocked dependencies
    integration: Integration tests - Medium, PostgreSQL, real services
    e2e: End-to-end tests - Slow, PostgreSQL + HTTP, full stack
    slow: Tests that take >5 seconds
    ci: Tests designed for CI environment

# Command-line options
addopts =
    -v
    --tb=short
    --strict-markers
    --disable-warnings

# Minimum pytest version
minversion = 8.0

# pytest-asyncio 1.x configuration (Breaking changes from 0.x)
# See: https://pytest-asyncio.readthedocs.io/en/latest/
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function
asyncio_default_test_loop_scope = function

# Environment configuration (pytest-dotenv)
env_files =
    .env.test

# Files to ignore during collection
collect_ignore =
    setup.py
    venv
    .venv
    tests/deprecated

# Logging configuration (optional)
# log_cli = true
# log_cli_level = INFO
